<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>05. Source reconstruction and HNN &#8212; hnn-core  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          hnn-core</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Examples</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../whats_new.html">Whats new</a></li>
                <li><a href="https://github.com/jonescompneurolab/hnn-core">GitHub</a></li>
                <li><a href="../roadmap.html">Roadmap</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">05. Source reconstruction and HNN</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/auto_examples/plot_simulate_somato.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-simulate-somato-py"><span class="std std-ref">here</span></a>
to download the full example code or to run this example in your browser via Binder</p>
</div>
<div class="sphx-glr-example-title section" id="source-reconstruction-and-hnn">
<span id="sphx-glr-auto-examples-plot-simulate-somato-py"></span><h1>05. Source reconstruction and HNN<a class="headerlink" href="#source-reconstruction-and-hnn" title="Permalink to this headline">Â¶</a></h1>
<p>This example demonstrates how to simulate the source time
courses obtained during median nerve stimulation in the MNE
somatosensory dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Mainak Jas &lt;mainakjas@gmail.com&gt;</span>
<span class="c1">#          Ryan Thorpe &lt;ryan_thorpe@brown.edu&gt;</span>
</pre></div>
</div>
<p>First, we will import the packages and define the paths. For this example,
we will need <a class="reference external" href="https://mne.tools/">MNE</a> installed. For most practical purposes, you can simply
do:</p>
<blockquote>
<div><p>$ pip install mne</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">somato</span>
<span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <a href="https://mne.tools/dev/generated/mne.minimum_norm.apply_inverse.html#mne.minimum_norm.apply_inverse" title="mne.minimum_norm.apply_inverse" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">apply_inverse</span></a><span class="p">,</span> <a href="https://mne.tools/dev/generated/mne.minimum_norm.make_inverse_operator.html#mne.minimum_norm.make_inverse_operator" title="mne.minimum_norm.make_inverse_operator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">make_inverse_operator</span></a>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.datasets.somato.data_path.html#mne.datasets.somato.data_path" title="mne.datasets.somato.data_path" class="sphx-glr-backref-module-mne-datasets-somato sphx-glr-backref-type-py-function"><span class="n">somato</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a> <span class="o">=</span> <span class="s1">&#39;01&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">task</span></a> <span class="o">=</span> <span class="s1">&#39;somato&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">),</span> <span class="s1">&#39;meg&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;sub-</span><span class="si">{}</span><span class="s1">_task-</span><span class="si">{}</span><span class="s1">_meg.fif&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">task</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">),</span>
                    <span class="s1">&#39;sub-</span><span class="si">{}</span><span class="s1">_task-</span><span class="si">{}</span><span class="s1">-fwd.fif&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">task</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;freesurfer&#39;</span><span class="p">,</span> <span class="s1">&#39;subjects&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using default location ~/mne_data for somato...
Creating ~/mne_data
Downloading archive MNE-somato-data.tar.gz to /home/circleci/mne_data
Downloading https://files.osf.io/v1/resources/rxvq7/providers/osfstorage/59c0e2849ad5a1025d4b7346?version=7&amp;action=download&amp;direct (582.2 MB)

  0%|          | Downloading : 0.00/582M [00:00&lt;?,        ?B/s]
  0%|          | Downloading : 248k/582M [00:00&lt;00:42,    14.5MB/s]
  0%|          | Downloading : 760k/582M [00:00&lt;00:41,    14.8MB/s]
  0%|          | Downloading : 2.24M/582M [00:00&lt;00:39,    15.5MB/s]
  1%|1         | Downloading : 6.24M/582M [00:00&lt;00:37,    16.2MB/s]
  1%|1         | Downloading : 8.24M/582M [00:00&lt;00:36,    16.6MB/s]
  2%|1         | Downloading : 10.2M/582M [00:00&lt;00:35,    17.0MB/s]
  2%|2         | Downloading : 12.2M/582M [00:00&lt;00:34,    17.4MB/s]
  2%|2         | Downloading : 14.2M/582M [00:00&lt;00:32,    18.1MB/s]
  3%|2         | Downloading : 16.2M/582M [00:00&lt;00:31,    18.8MB/s]
  3%|3         | Downloading : 18.2M/582M [00:00&lt;00:31,    18.9MB/s]
  3%|3         | Downloading : 20.2M/582M [00:00&lt;00:30,    19.1MB/s]
  4%|3         | Downloading : 22.2M/582M [00:00&lt;00:29,    19.9MB/s]
  5%|4         | Downloading : 26.2M/582M [00:00&lt;00:28,    20.6MB/s]
  5%|4         | Downloading : 28.2M/582M [00:00&lt;00:27,    21.4MB/s]
  5%|5         | Downloading : 30.2M/582M [00:00&lt;00:25,    22.3MB/s]
  6%|5         | Downloading : 32.2M/582M [00:00&lt;00:24,    23.2MB/s]
  6%|5         | Downloading : 34.2M/582M [00:00&lt;00:24,    23.9MB/s]
  6%|6         | Downloading : 36.2M/582M [00:00&lt;00:23,    24.6MB/s]
  7%|6         | Downloading : 38.2M/582M [00:00&lt;00:22,    25.4MB/s]
  7%|6         | Downloading : 40.2M/582M [00:00&lt;00:21,    26.2MB/s]
  7%|7         | Downloading : 42.2M/582M [00:00&lt;00:20,    27.1MB/s]
  8%|7         | Downloading : 44.2M/582M [00:00&lt;00:19,    28.3MB/s]
  8%|7         | Downloading : 46.2M/582M [00:00&lt;00:19,    29.3MB/s]
  8%|8         | Downloading : 48.2M/582M [00:00&lt;00:18,    30.4MB/s]
  9%|8         | Downloading : 50.2M/582M [00:00&lt;00:17,    31.5MB/s]
  9%|8         | Downloading : 52.2M/582M [00:00&lt;00:17,    32.6MB/s]
  9%|9         | Downloading : 54.2M/582M [00:00&lt;00:16,    33.8MB/s]
 10%|9         | Downloading : 56.2M/582M [00:00&lt;00:15,    34.9MB/s]
 10%|#         | Downloading : 58.2M/582M [00:01&lt;00:15,    36.1MB/s]
 10%|#         | Downloading : 60.2M/582M [00:01&lt;00:14,    37.3MB/s]
 11%|#         | Downloading : 62.2M/582M [00:01&lt;00:14,    38.4MB/s]
 11%|#1        | Downloading : 64.2M/582M [00:01&lt;00:13,    39.5MB/s]
 11%|#1        | Downloading : 66.2M/582M [00:01&lt;00:13,    40.7MB/s]
 12%|#1        | Downloading : 68.2M/582M [00:01&lt;00:12,    41.9MB/s]
 12%|#2        | Downloading : 70.2M/582M [00:01&lt;00:12,    43.0MB/s]
 12%|#2        | Downloading : 72.2M/582M [00:01&lt;00:12,    44.2MB/s]
 13%|#2        | Downloading : 74.2M/582M [00:01&lt;00:11,    45.4MB/s]
 13%|#3        | Downloading : 76.2M/582M [00:01&lt;00:11,    46.7MB/s]
 13%|#3        | Downloading : 78.2M/582M [00:01&lt;00:11,    48.0MB/s]
 14%|#3        | Downloading : 80.2M/582M [00:01&lt;00:10,    48.9MB/s]
 14%|#4        | Downloading : 82.2M/582M [00:01&lt;00:10,    50.3MB/s]
 14%|#4        | Downloading : 84.2M/582M [00:01&lt;00:10,    51.2MB/s]
 15%|#4        | Downloading : 86.2M/582M [00:01&lt;00:09,    52.3MB/s]
 15%|#5        | Downloading : 88.2M/582M [00:01&lt;00:09,    53.3MB/s]
 15%|#5        | Downloading : 90.2M/582M [00:01&lt;00:09,    54.2MB/s]
 16%|#5        | Downloading : 92.2M/582M [00:01&lt;00:09,    54.6MB/s]
 16%|#6        | Downloading : 94.2M/582M [00:01&lt;00:09,    54.4MB/s]
 17%|#6        | Downloading : 98.2M/582M [00:01&lt;00:09,    56.1MB/s]
 17%|#7        | Downloading : 100M/582M [00:01&lt;00:08,    57.7MB/s]
 18%|#8        | Downloading : 106M/582M [00:01&lt;00:08,    59.4MB/s]
 19%|#8        | Downloading : 110M/582M [00:01&lt;00:08,    61.2MB/s]
 20%|#9        | Downloading : 114M/582M [00:01&lt;00:08,    61.1MB/s]
 20%|##        | Downloading : 118M/582M [00:01&lt;00:07,    61.3MB/s]
 21%|##        | Downloading : 122M/582M [00:01&lt;00:07,    61.4MB/s]
 22%|##1       | Downloading : 126M/582M [00:01&lt;00:08,    59.4MB/s]
 22%|##2       | Downloading : 128M/582M [00:01&lt;00:07,    60.6MB/s]
 22%|##2       | Downloading : 130M/582M [00:01&lt;00:07,    61.2MB/s]
 23%|##2       | Downloading : 132M/582M [00:01&lt;00:07,    62.0MB/s]
 23%|##3       | Downloading : 134M/582M [00:01&lt;00:07,    63.3MB/s]
 23%|##3       | Downloading : 136M/582M [00:02&lt;00:07,    64.6MB/s]
 24%|##3       | Downloading : 138M/582M [00:02&lt;00:07,    65.0MB/s]
 24%|##4       | Downloading : 140M/582M [00:02&lt;00:07,    63.5MB/s]
 24%|##4       | Downloading : 142M/582M [00:02&lt;00:07,    63.4MB/s]
 25%|##4       | Downloading : 144M/582M [00:02&lt;00:07,    64.3MB/s]
 25%|##5       | Downloading : 146M/582M [00:02&lt;00:07,    65.2MB/s]
 25%|##5       | Downloading : 148M/582M [00:02&lt;00:07,    65.0MB/s]
 26%|##5       | Downloading : 150M/582M [00:02&lt;00:06,    66.6MB/s]
 26%|##6       | Downloading : 152M/582M [00:02&lt;00:06,    67.2MB/s]
 26%|##6       | Downloading : 154M/582M [00:02&lt;00:06,    67.7MB/s]
 27%|##6       | Downloading : 156M/582M [00:02&lt;00:06,    68.9MB/s]
 27%|##7       | Downloading : 158M/582M [00:02&lt;00:06,    70.1MB/s]
 28%|##7       | Downloading : 160M/582M [00:02&lt;00:06,    71.8MB/s]
 29%|##8       | Downloading : 166M/582M [00:02&lt;00:06,    71.9MB/s]
 29%|##9       | Downloading : 170M/582M [00:02&lt;00:05,    72.0MB/s]
 30%|##9       | Downloading : 174M/582M [00:02&lt;00:05,    71.4MB/s]
 31%|###       | Downloading : 178M/582M [00:02&lt;00:05,    72.2MB/s]
 31%|###1      | Downloading : 182M/582M [00:02&lt;00:05,    72.7MB/s]
 32%|###1      | Downloading : 186M/582M [00:02&lt;00:05,    73.5MB/s]
 33%|###2      | Downloading : 190M/582M [00:02&lt;00:05,    75.0MB/s]
 33%|###3      | Downloading : 194M/582M [00:02&lt;00:05,    77.2MB/s]
 34%|###4      | Downloading : 198M/582M [00:02&lt;00:05,    77.7MB/s]
 35%|###4      | Downloading : 202M/582M [00:02&lt;00:05,    74.5MB/s]
 35%|###5      | Downloading : 206M/582M [00:02&lt;00:05,    75.1MB/s]
 36%|###6      | Downloading : 210M/582M [00:02&lt;00:05,    77.0MB/s]
 37%|###6      | Downloading : 214M/582M [00:02&lt;00:04,    78.7MB/s]
 37%|###7      | Downloading : 218M/582M [00:03&lt;00:04,    79.9MB/s]
 38%|###8      | Downloading : 222M/582M [00:03&lt;00:04,    80.3MB/s]
 39%|###8      | Downloading : 226M/582M [00:03&lt;00:04,    82.1MB/s]
 40%|###9      | Downloading : 230M/582M [00:03&lt;00:04,    79.6MB/s]
 40%|####      | Downloading : 234M/582M [00:03&lt;00:04,    79.0MB/s]
 41%|####      | Downloading : 238M/582M [00:03&lt;00:04,    79.8MB/s]
 42%|####1     | Downloading : 242M/582M [00:03&lt;00:04,    76.1MB/s]
 42%|####1     | Downloading : 244M/582M [00:03&lt;00:05,    67.5MB/s]
 42%|####2     | Downloading : 246M/582M [00:03&lt;00:05,    69.0MB/s]
 43%|####2     | Downloading : 248M/582M [00:03&lt;00:04,    70.4MB/s]
 43%|####2     | Downloading : 250M/582M [00:03&lt;00:05,    69.5MB/s]
 43%|####3     | Downloading : 252M/582M [00:03&lt;00:04,    69.7MB/s]
 44%|####3     | Downloading : 254M/582M [00:03&lt;00:05,    68.8MB/s]
 44%|####4     | Downloading : 256M/582M [00:03&lt;00:04,    69.2MB/s]
 44%|####4     | Downloading : 258M/582M [00:03&lt;00:04,    69.3MB/s]
 45%|####4     | Downloading : 260M/582M [00:03&lt;00:04,    70.0MB/s]
 45%|####5     | Downloading : 262M/582M [00:03&lt;00:04,    70.2MB/s]
 45%|####5     | Downloading : 264M/582M [00:03&lt;00:04,    70.9MB/s]
 46%|####5     | Downloading : 266M/582M [00:03&lt;00:04,    72.4MB/s]
 46%|####6     | Downloading : 268M/582M [00:03&lt;00:04,    72.8MB/s]
 46%|####6     | Downloading : 270M/582M [00:03&lt;00:04,    73.6MB/s]
 47%|####6     | Downloading : 272M/582M [00:03&lt;00:04,    74.7MB/s]
 47%|####7     | Downloading : 274M/582M [00:03&lt;00:04,    75.1MB/s]
 47%|####7     | Downloading : 276M/582M [00:03&lt;00:04,    75.5MB/s]
 48%|####7     | Downloading : 278M/582M [00:03&lt;00:04,    75.2MB/s]
 48%|####8     | Downloading : 280M/582M [00:03&lt;00:04,    74.6MB/s]
 48%|####8     | Downloading : 282M/582M [00:03&lt;00:04,    74.4MB/s]
 49%|####8     | Downloading : 284M/582M [00:04&lt;00:04,    73.8MB/s]
 49%|####9     | Downloading : 286M/582M [00:04&lt;00:04,    74.1MB/s]
 50%|####9     | Downloading : 288M/582M [00:04&lt;00:04,    74.1MB/s]
 50%|####9     | Downloading : 290M/582M [00:04&lt;00:04,    73.4MB/s]
 50%|#####     | Downloading : 292M/582M [00:04&lt;00:04,    73.2MB/s]
 51%|#####     | Downloading : 294M/582M [00:04&lt;00:04,    72.4MB/s]
 51%|#####     | Downloading : 296M/582M [00:04&lt;00:04,    72.8MB/s]
 51%|#####1    | Downloading : 298M/582M [00:04&lt;00:04,    72.8MB/s]
 52%|#####1    | Downloading : 300M/582M [00:04&lt;00:04,    72.8MB/s]
 52%|#####1    | Downloading : 302M/582M [00:04&lt;00:04,    73.4MB/s]
 52%|#####2    | Downloading : 304M/582M [00:04&lt;00:03,    73.4MB/s]
 53%|#####2    | Downloading : 306M/582M [00:04&lt;00:03,    73.7MB/s]
 53%|#####2    | Downloading : 308M/582M [00:04&lt;00:04,    67.5MB/s]
 53%|#####3    | Downloading : 310M/582M [00:04&lt;00:05,    52.8MB/s]
 53%|#####3    | Downloading : 311M/582M [00:04&lt;00:06,    43.7MB/s]
 54%|#####3    | Downloading : 312M/582M [00:04&lt;00:06,    42.4MB/s]
 54%|#####3    | Downloading : 313M/582M [00:04&lt;00:06,    40.5MB/s]
 54%|#####3    | Downloading : 314M/582M [00:04&lt;00:07,    39.7MB/s]
 54%|#####3    | Downloading : 314M/582M [00:04&lt;00:07,    38.2MB/s]
 54%|#####4    | Downloading : 315M/582M [00:04&lt;00:07,    36.1MB/s]
 54%|#####4    | Downloading : 316M/582M [00:04&lt;00:07,    36.9MB/s]
 55%|#####4    | Downloading : 318M/582M [00:04&lt;00:07,    38.0MB/s]
 55%|#####4    | Downloading : 319M/582M [00:04&lt;00:07,    36.8MB/s]
 55%|#####5    | Downloading : 320M/582M [00:04&lt;00:07,    36.9MB/s]
 55%|#####5    | Downloading : 321M/582M [00:05&lt;00:07,    35.9MB/s]
 55%|#####5    | Downloading : 322M/582M [00:05&lt;00:08,    33.1MB/s]
 56%|#####5    | Downloading : 323M/582M [00:05&lt;00:09,    29.1MB/s]
 56%|#####5    | Downloading : 325M/582M [00:05&lt;00:08,    30.1MB/s]
 56%|#####6    | Downloading : 328M/582M [00:05&lt;00:08,    30.8MB/s]
 57%|#####6    | Downloading : 330M/582M [00:05&lt;00:08,    31.1MB/s]
 57%|#####6    | Downloading : 332M/582M [00:05&lt;00:08,    31.4MB/s]
 57%|#####7    | Downloading : 334M/582M [00:05&lt;00:08,    32.5MB/s]
 58%|#####7    | Downloading : 336M/582M [00:05&lt;00:07,    33.1MB/s]
 58%|#####8    | Downloading : 338M/582M [00:05&lt;00:07,    33.3MB/s]
 58%|#####8    | Downloading : 340M/582M [00:05&lt;00:07,    32.4MB/s]
 59%|#####8    | Downloading : 342M/582M [00:05&lt;00:07,    31.8MB/s]
 59%|#####9    | Downloading : 344M/582M [00:05&lt;00:08,    31.2MB/s]
 59%|#####9    | Downloading : 346M/582M [00:05&lt;00:07,    31.5MB/s]
 60%|#####9    | Downloading : 348M/582M [00:05&lt;00:07,    32.1MB/s]
 60%|######    | Downloading : 350M/582M [00:05&lt;00:07,    33.1MB/s]
 60%|######    | Downloading : 352M/582M [00:05&lt;00:07,    34.1MB/s]
 61%|######    | Downloading : 354M/582M [00:06&lt;00:06,    34.7MB/s]
 61%|######1   | Downloading : 356M/582M [00:06&lt;00:06,    35.7MB/s]
 61%|######1   | Downloading : 358M/582M [00:06&lt;00:06,    36.3MB/s]
 62%|######1   | Downloading : 360M/582M [00:06&lt;00:06,    37.1MB/s]
 62%|######2   | Downloading : 362M/582M [00:06&lt;00:06,    38.1MB/s]
 62%|######2   | Downloading : 364M/582M [00:06&lt;00:05,    39.0MB/s]
 63%|######2   | Downloading : 366M/582M [00:06&lt;00:05,    39.8MB/s]
 63%|######3   | Downloading : 368M/582M [00:06&lt;00:05,    40.8MB/s]
 64%|######3   | Downloading : 370M/582M [00:06&lt;00:05,    41.8MB/s]
 64%|######3   | Downloading : 372M/582M [00:06&lt;00:05,    42.7MB/s]
 64%|######4   | Downloading : 374M/582M [00:06&lt;00:05,    43.5MB/s]
 65%|######4   | Downloading : 376M/582M [00:06&lt;00:04,    44.7MB/s]
 65%|######4   | Downloading : 378M/582M [00:06&lt;00:04,    45.6MB/s]
 65%|######5   | Downloading : 380M/582M [00:06&lt;00:04,    46.5MB/s]
 66%|######5   | Downloading : 382M/582M [00:06&lt;00:04,    47.3MB/s]
 66%|######5   | Downloading : 384M/582M [00:06&lt;00:04,    47.9MB/s]
 66%|######6   | Downloading : 386M/582M [00:06&lt;00:04,    49.0MB/s]
 67%|######6   | Downloading : 388M/582M [00:06&lt;00:04,    49.9MB/s]
 67%|######6   | Downloading : 390M/582M [00:06&lt;00:03,    50.9MB/s]
 67%|######7   | Downloading : 392M/582M [00:06&lt;00:03,    51.6MB/s]
 68%|######7   | Downloading : 394M/582M [00:06&lt;00:03,    52.5MB/s]
 68%|######7   | Downloading : 396M/582M [00:06&lt;00:03,    53.2MB/s]
 68%|######8   | Downloading : 398M/582M [00:06&lt;00:03,    54.4MB/s]
 69%|######8   | Downloading : 400M/582M [00:06&lt;00:03,    55.2MB/s]
 69%|######9   | Downloading : 402M/582M [00:06&lt;00:03,    55.7MB/s]
 69%|######9   | Downloading : 404M/582M [00:06&lt;00:03,    55.4MB/s]
 70%|######9   | Downloading : 406M/582M [00:06&lt;00:03,    55.2MB/s]
 70%|#######   | Downloading : 408M/582M [00:06&lt;00:03,    55.8MB/s]
 70%|#######   | Downloading : 410M/582M [00:06&lt;00:03,    56.1MB/s]
 71%|#######   | Downloading : 412M/582M [00:06&lt;00:03,    56.4MB/s]
 71%|#######1  | Downloading : 414M/582M [00:06&lt;00:03,    57.4MB/s]
 72%|#######1  | Downloading : 418M/582M [00:07&lt;00:03,    56.1MB/s]
 72%|#######2  | Downloading : 420M/582M [00:07&lt;00:03,    52.4MB/s]
 72%|#######2  | Downloading : 422M/582M [00:07&lt;00:03,    52.5MB/s]
 73%|#######2  | Downloading : 424M/582M [00:07&lt;00:03,    48.0MB/s]
 73%|#######2  | Downloading : 425M/582M [00:07&lt;00:04,    40.2MB/s]
 73%|#######3  | Downloading : 425M/582M [00:07&lt;00:04,    38.4MB/s]
 73%|#######3  | Downloading : 426M/582M [00:07&lt;00:04,    36.8MB/s]
 73%|#######3  | Downloading : 426M/582M [00:07&lt;00:04,    36.2MB/s]
 73%|#######3  | Downloading : 427M/582M [00:07&lt;00:04,    34.9MB/s]
 73%|#######3  | Downloading : 427M/582M [00:07&lt;00:05,    30.0MB/s]
 73%|#######3  | Downloading : 428M/582M [00:07&lt;00:05,    27.4MB/s]
 74%|#######3  | Downloading : 429M/582M [00:07&lt;00:05,    27.6MB/s]
 74%|#######3  | Downloading : 430M/582M [00:07&lt;00:05,    26.9MB/s]
 74%|#######4  | Downloading : 431M/582M [00:07&lt;00:05,    27.5MB/s]
 74%|#######4  | Downloading : 432M/582M [00:07&lt;00:05,    27.9MB/s]
 74%|#######4  | Downloading : 433M/582M [00:07&lt;00:05,    28.7MB/s]
 75%|#######4  | Downloading : 434M/582M [00:07&lt;00:05,    29.4MB/s]
 75%|#######4  | Downloading : 435M/582M [00:07&lt;00:05,    30.1MB/s]
 75%|#######4  | Downloading : 436M/582M [00:07&lt;00:04,    30.8MB/s]
 75%|#######5  | Downloading : 437M/582M [00:07&lt;00:04,    31.6MB/s]
 75%|#######5  | Downloading : 438M/582M [00:07&lt;00:04,    32.4MB/s]
 75%|#######5  | Downloading : 439M/582M [00:07&lt;00:04,    33.2MB/s]
 76%|#######5  | Downloading : 441M/582M [00:07&lt;00:04,    34.2MB/s]
 76%|#######5  | Downloading : 442M/582M [00:07&lt;00:04,    32.6MB/s]
 76%|#######6  | Downloading : 443M/582M [00:07&lt;00:04,    33.0MB/s]
 76%|#######6  | Downloading : 444M/582M [00:07&lt;00:04,    33.7MB/s]
 76%|#######6  | Downloading : 445M/582M [00:07&lt;00:04,    34.5MB/s]
 77%|#######6  | Downloading : 446M/582M [00:08&lt;00:04,    34.8MB/s]
 77%|#######6  | Downloading : 447M/582M [00:08&lt;00:03,    35.4MB/s]
 77%|#######6  | Downloading : 448M/582M [00:08&lt;00:04,    35.0MB/s]
 77%|#######7  | Downloading : 449M/582M [00:08&lt;00:04,    33.7MB/s]
 77%|#######7  | Downloading : 450M/582M [00:08&lt;00:04,    33.2MB/s]
 78%|#######7  | Downloading : 452M/582M [00:08&lt;00:03,    34.2MB/s]
 78%|#######7  | Downloading : 453M/582M [00:08&lt;00:03,    34.8MB/s]
 78%|#######8  | Downloading : 454M/582M [00:08&lt;00:03,    35.7MB/s]
 78%|#######8  | Downloading : 456M/582M [00:08&lt;00:03,    36.6MB/s]
 79%|#######8  | Downloading : 457M/582M [00:08&lt;00:03,    37.4MB/s]
 79%|#######8  | Downloading : 458M/582M [00:08&lt;00:03,    38.2MB/s]
 79%|#######8  | Downloading : 459M/582M [00:08&lt;00:03,    38.8MB/s]
 79%|#######9  | Downloading : 461M/582M [00:08&lt;00:03,    39.7MB/s]
 80%|#######9  | Downloading : 463M/582M [00:08&lt;00:03,    40.7MB/s]
 80%|#######9  | Downloading : 465M/582M [00:08&lt;00:03,    38.0MB/s]
 80%|########  | Downloading : 466M/582M [00:08&lt;00:03,    38.5MB/s]
 80%|########  | Downloading : 467M/582M [00:08&lt;00:03,    39.0MB/s]
 80%|########  | Downloading : 468M/582M [00:08&lt;00:03,    39.5MB/s]
 81%|########  | Downloading : 470M/582M [00:08&lt;00:02,    39.6MB/s]
 81%|########  | Downloading : 471M/582M [00:08&lt;00:03,    37.8MB/s]
 81%|########1 | Downloading : 472M/582M [00:08&lt;00:03,    38.1MB/s]
 81%|########1 | Downloading : 473M/582M [00:08&lt;00:02,    38.8MB/s]
 81%|########1 | Downloading : 474M/582M [00:08&lt;00:02,    37.9MB/s]
 82%|########1 | Downloading : 475M/582M [00:08&lt;00:03,    35.5MB/s]
 82%|########1 | Downloading : 476M/582M [00:08&lt;00:03,    31.2MB/s]
 82%|########1 | Downloading : 477M/582M [00:08&lt;00:03,    28.9MB/s]
 82%|########1 | Downloading : 477M/582M [00:08&lt;00:03,    28.0MB/s]
 82%|########2 | Downloading : 478M/582M [00:09&lt;00:04,    27.3MB/s]
 82%|########2 | Downloading : 478M/582M [00:09&lt;00:04,    26.0MB/s]
 82%|########2 | Downloading : 479M/582M [00:09&lt;00:04,    25.5MB/s]
 82%|########2 | Downloading : 479M/582M [00:09&lt;00:04,    25.7MB/s]
 82%|########2 | Downloading : 480M/582M [00:09&lt;00:04,    25.9MB/s]
 82%|########2 | Downloading : 480M/582M [00:09&lt;00:04,    25.7MB/s]
 83%|########2 | Downloading : 481M/582M [00:09&lt;00:04,    25.5MB/s]
 83%|########2 | Downloading : 481M/582M [00:09&lt;00:04,    25.5MB/s]
 83%|########2 | Downloading : 482M/582M [00:09&lt;00:04,    25.8MB/s]
 83%|########2 | Downloading : 483M/582M [00:09&lt;00:04,    25.1MB/s]
 83%|########2 | Downloading : 483M/582M [00:09&lt;00:04,    25.1MB/s]
 83%|########3 | Downloading : 484M/582M [00:09&lt;00:04,    25.3MB/s]
 83%|########3 | Downloading : 484M/582M [00:09&lt;00:04,    24.7MB/s]
 83%|########3 | Downloading : 485M/582M [00:09&lt;00:04,    25.0MB/s]
 83%|########3 | Downloading : 485M/582M [00:09&lt;00:04,    24.8MB/s]
 83%|########3 | Downloading : 486M/582M [00:09&lt;00:04,    24.9MB/s]
 84%|########3 | Downloading : 486M/582M [00:09&lt;00:04,    24.3MB/s]
 84%|########3 | Downloading : 487M/582M [00:09&lt;00:04,    24.6MB/s]
 84%|########3 | Downloading : 488M/582M [00:09&lt;00:03,    25.1MB/s]
 84%|########4 | Downloading : 489M/582M [00:09&lt;00:03,    25.7MB/s]
 85%|########4 | Downloading : 492M/582M [00:09&lt;00:03,    26.7MB/s]
 85%|########4 | Downloading : 494M/582M [00:09&lt;00:03,    27.7MB/s]
 85%|########5 | Downloading : 496M/582M [00:09&lt;00:03,    28.8MB/s]
 86%|########5 | Downloading : 500M/582M [00:09&lt;00:02,    30.0MB/s]
 87%|########6 | Downloading : 504M/582M [00:09&lt;00:02,    31.1MB/s]
 87%|########6 | Downloading : 506M/582M [00:09&lt;00:02,    32.1MB/s]
 87%|########7 | Downloading : 508M/582M [00:09&lt;00:02,    33.3MB/s]
 88%|########7 | Downloading : 510M/582M [00:09&lt;00:02,    34.3MB/s]
 88%|########7 | Downloading : 512M/582M [00:09&lt;00:02,    35.2MB/s]
 88%|########8 | Downloading : 514M/582M [00:09&lt;00:01,    36.3MB/s]
 89%|########8 | Downloading : 516M/582M [00:09&lt;00:01,    37.4MB/s]
 89%|########9 | Downloading : 520M/582M [00:09&lt;00:01,    36.7MB/s]
 90%|########9 | Downloading : 521M/582M [00:09&lt;00:01,    36.9MB/s]
 90%|########9 | Downloading : 522M/582M [00:09&lt;00:01,    37.0MB/s]
 90%|########9 | Downloading : 523M/582M [00:09&lt;00:01,    37.6MB/s]
 90%|######### | Downloading : 524M/582M [00:10&lt;00:01,    37.8MB/s]
 90%|######### | Downloading : 525M/582M [00:10&lt;00:01,    38.0MB/s]
 90%|######### | Downloading : 526M/582M [00:10&lt;00:01,    38.3MB/s]
 91%|######### | Downloading : 527M/582M [00:10&lt;00:01,    38.9MB/s]
 91%|######### | Downloading : 528M/582M [00:10&lt;00:01,    33.1MB/s]
 91%|######### | Downloading : 529M/582M [00:10&lt;00:01,    33.4MB/s]
 91%|######### | Downloading : 530M/582M [00:10&lt;00:01,    30.5MB/s]
 91%|#########1| Downloading : 530M/582M [00:10&lt;00:02,    25.5MB/s]
 91%|#########1| Downloading : 531M/582M [00:10&lt;00:02,    24.3MB/s]
 91%|#########1| Downloading : 531M/582M [00:10&lt;00:02,    24.4MB/s]
 92%|#########1| Downloading : 533M/582M [00:10&lt;00:02,    24.8MB/s]
 92%|#########1| Downloading : 534M/582M [00:10&lt;00:01,    25.5MB/s]
 92%|#########1| Downloading : 535M/582M [00:10&lt;00:01,    26.0MB/s]
 92%|#########2| Downloading : 536M/582M [00:10&lt;00:01,    26.6MB/s]
 92%|#########2| Downloading : 537M/582M [00:10&lt;00:01,    27.2MB/s]
 92%|#########2| Downloading : 538M/582M [00:10&lt;00:01,    28.0MB/s]
 93%|#########2| Downloading : 539M/582M [00:10&lt;00:01,    28.7MB/s]
 93%|#########2| Downloading : 540M/582M [00:10&lt;00:01,    28.2MB/s]
 93%|#########2| Downloading : 541M/582M [00:10&lt;00:01,    27.5MB/s]
 93%|#########3| Downloading : 542M/582M [00:10&lt;00:01,    26.8MB/s]
 93%|#########3| Downloading : 543M/582M [00:10&lt;00:01,    27.1MB/s]
 93%|#########3| Downloading : 544M/582M [00:10&lt;00:01,    27.9MB/s]
 94%|#########3| Downloading : 545M/582M [00:10&lt;00:01,    28.5MB/s]
 94%|#########3| Downloading : 546M/582M [00:10&lt;00:01,    28.8MB/s]
 94%|#########3| Downloading : 547M/582M [00:10&lt;00:01,    28.4MB/s]
 94%|#########4| Downloading : 548M/582M [00:10&lt;00:01,    27.8MB/s]
 94%|#########4| Downloading : 549M/582M [00:10&lt;00:01,    28.2MB/s]
 94%|#########4| Downloading : 550M/582M [00:10&lt;00:01,    28.5MB/s]
 95%|#########4| Downloading : 551M/582M [00:11&lt;00:01,    28.7MB/s]
 95%|#########4| Downloading : 552M/582M [00:11&lt;00:01,    28.9MB/s]
 95%|#########4| Downloading : 553M/582M [00:11&lt;00:01,    27.9MB/s]
 95%|#########5| Downloading : 554M/582M [00:11&lt;00:01,    28.1MB/s]
 95%|#########5| Downloading : 555M/582M [00:11&lt;00:01,    28.6MB/s]
 95%|#########5| Downloading : 556M/582M [00:11&lt;00:00,    28.9MB/s]
 96%|#########5| Downloading : 558M/582M [00:11&lt;00:00,    29.5MB/s]
 96%|#########5| Downloading : 559M/582M [00:11&lt;00:00,    29.3MB/s]
 96%|#########6| Downloading : 560M/582M [00:11&lt;00:00,    29.7MB/s]
 96%|#########6| Downloading : 561M/582M [00:11&lt;00:00,    30.4MB/s]
 96%|#########6| Downloading : 562M/582M [00:11&lt;00:00,    31.0MB/s]
 97%|#########6| Downloading : 564M/582M [00:11&lt;00:00,    31.9MB/s]
 97%|#########6| Downloading : 565M/582M [00:11&lt;00:00,    32.6MB/s]
 97%|#########7| Downloading : 567M/582M [00:11&lt;00:00,    33.6MB/s]
 98%|#########7| Downloading : 569M/582M [00:11&lt;00:00,    34.5MB/s]
 98%|#########8| Downloading : 571M/582M [00:11&lt;00:00,    35.5MB/s]
 98%|#########8| Downloading : 573M/582M [00:11&lt;00:00,    36.4MB/s]
 99%|#########8| Downloading : 575M/582M [00:11&lt;00:00,    37.4MB/s]
 99%|#########9| Downloading : 577M/582M [00:11&lt;00:00,    38.4MB/s]
 99%|#########9| Downloading : 579M/582M [00:11&lt;00:00,    39.4MB/s]
100%|#########9| Downloading : 582M/582M [00:11&lt;00:00,    40.5MB/s]
100%|##########| Downloading : 582M/582M [00:11&lt;00:00,    52.4MB/s]
Verifying hash 32fd2f6c8c7eb0784a1de6435273c48b.
Decompressing the archive: /home/circleci/mne_data/MNE-somato-data.tar.gz
(please be patient, this can take some time)
Successfully extracted to: [&#39;/home/circleci/mne_data/MNE-somato-data&#39;]
Attempting to create new mne-python configuration file:
/home/circleci/.mne/mne-python.json
</pre></div>
</div>
<p>Then, we get the raw data and estimage the source time course</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">filter</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="kc">None</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="n">baseline</span><span class="p">,</span>
                    <span class="n">reject</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">350e-6</span><span class="p">),</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs.average" title="mne.Epochs.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span>

<a href="https://mne.tools/dev/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.read_forward_solution.html#mne.read_forward_solution" title="mne.read_forward_solution" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_forward_solution</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd_fname</span></a><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.compute_covariance.html#mne.compute_covariance" title="mne.compute_covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">compute_covariance</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.minimum_norm.InverseOperator.html#mne.minimum_norm.InverseOperator" title="mne.minimum_norm.InverseOperator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inv</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.minimum_norm.make_inverse_operator.html#mne.minimum_norm.make_inverse_operator" title="mne.minimum_norm.make_inverse_operator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">make_inverse_operator</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://mne.tools/dev/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span> <a href="https://mne.tools/dev/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-somato-data/sub-01/meg/sub-01_task-somato_meg.fif...
    Range : 237600 ... 506999 =    791.189 ...  1688.266 secs
Ready.
Reading 0 ... 269399  =      0.000 ...   897.077 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 993 samples (3.307 sec)

111 events found
Event IDs: [1]
Not setting metadata
Not setting metadata
111 matching events found
No baseline correction applied
0 projection items activated
Loading data for 111 events and 106 original time points ...
0 bad epochs dropped
Reading forward solution from /home/circleci/mne_data/MNE-somato-data/derivatives/sub-01/sub-01_task-somato-fwd.fif...
    Reading a source space...
    [done]
    Reading a source space...
    [done]
    2 source spaces read
    Desired named matrix (kind = 3523) not available
    Read MEG forward solution (8155 sources, 306 channels, free orientations)
    Source spaces transformed to the forward solution coordinate frame
Computing rank from data with rank=None
    Using tolerance 1.4e-08 (2.2e-16 eps * 306 dim * 2.1e+05  max singular value)
    Estimated rank (mag + grad): 306
    MEG: rank 306 computed from 306 data channels with 0 projectors
/home/circleci/project/examples/plot_simulate_somato.py:51: RuntimeWarning: Something went wrong in the data-driven estimation of the data rank as it exceeds the theoretical rank from the info (306 &gt; 64). Consider setting rank to &quot;auto&quot; or setting it explicitly as an integer.
  cov = mne.compute_covariance(epochs)
Reducing data rank from 306 -&gt; 306
Estimating covariance using EMPIRICAL
Done.
Number of samples used : 11766
[done]
Converting forward solution to surface orientation
    No patch info available. The standard source space normals will be employed in the rotation to the local surface coordinates....
    Converting to surface-based source orientations...
    [done]
Computing inverse operator with 306 channels.
    306 out of 306 channels remain after picking
Selected 306 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 7615/8155 = 10.004172
    scale = 5.17919e-08 exp = 0.8
Applying loose dipole orientations to surface source spaces: 0.2
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 2e-12 (2.2e-16 eps * 306 dim * 29  max singular value)
    Estimated rank (mag + grad): 64
    MEG: rank 64 computed from 306 data channels with 0 projectors
    Setting small MEG eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.41945
    scaling factor to adjust the trace = 3.87831e+18
</pre></div>
</div>
<p>There are several methods to do source reconstruction. Some of the methods
such as MNE are distributed source methods whereas dipole fitting will
estimate the location and amplitude of a single current dipole. At the
moment, we do not offer explicit recommendations on which source
reconstruction technique is best for HNN. However, we do want our users
to note that the dipole currents simulate with HNN are assumed to be normal
to the cortical surface. Hence, using the option <code class="docutils literal notranslate"><span class="pre">pick_ori='normal'</span></code>
seems to make most sense.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a> <span class="o">=</span> <span class="s2">&quot;MNE&quot;</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">snr</span></a> <span class="o">=</span> <span class="mf">3.</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lambda2</span></a> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">snr</span></a> <span class="o">**</span> <span class="mi">2</span>
<a href="https://mne.tools/dev/generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stc</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.minimum_norm.apply_inverse.html#mne.minimum_norm.apply_inverse" title="mne.minimum_norm.apply_inverse" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">apply_inverse</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a><span class="p">,</span> <a href="https://mne.tools/dev/generated/mne.minimum_norm.InverseOperator.html#mne.minimum_norm.InverseOperator" title="mne.minimum_norm.InverseOperator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inv</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lambda2</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">,</span> <span class="n">pick_ori</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
                    <span class="n">return_residual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">pick_vertex</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.argmax.html#numpy.argmax" title="numpy.argmax" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">argmax</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.linalg.norm.html#numpy.linalg.norm" title="numpy.linalg.norm" class="sphx-glr-backref-module-numpy-linalg sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.SourceEstimate.html#mne.SourceEstimate.data" title="mne.SourceEstimate.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc</span><span class="o">.</span><span class="n">data</span></a><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <a href="https://mne.tools/dev/generated/mne.SourceEstimate.html#mne.SourceEstimate.times" title="mne.SourceEstimate.times" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://mne.tools/dev/generated/mne.SourceEstimate.html#mne.SourceEstimate.data" title="mne.SourceEstimate.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">pick_vertex</span></a><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;time (ms)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> value (nAM)&#39;</span> <span class="o">%</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlim.html#matplotlib.pyplot.xlim" title="matplotlib.pyplot.xlim" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.axhline.html#matplotlib.pyplot.axhline" title="matplotlib.pyplot.axhline" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="plot simulate somato" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_simulate_somato_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 111
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (242 small eigenvalues omitted)
Applying inverse operator to &quot;1&quot;...
    Picked 306 channels from the data
    Computing inverse...
    Eigenleads need to be weighted ...
    Computing residual...
    Explained  86.1% variance
[done]
</pre></div>
</div>
<p>Now, let us try to simulate the same with hnn-core. We read in the network
parameters from <code class="docutils literal notranslate"><span class="pre">N20.json</span></code> and explicitly create two distal and one
proximal evoked drive.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>

<span class="kn">import</span> <span class="nn">hnn_core</span>
<span class="kn">from</span> <span class="nn">hnn_core</span> <span class="kn">import</span> <a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.simulate_dipole.html#hnn_core.simulate_dipole" title="hnn_core.simulate_dipole" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-function"><span class="n">simulate_dipole</span></a><span class="p">,</span> <span class="n">read_params</span><span class="p">,</span> <a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network" title="hnn_core.Network" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-class"><span class="n">Network</span></a>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hnn_core_root</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.dirname" title="os.path.dirname" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">dirname</span></a><span class="p">(</span><span class="n">hnn_core</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hnn_core_root</span></a><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">,</span> <span class="s1">&#39;N20.json&#39;</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">read_params</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params_fname</span></a><span class="p">)</span>

<a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network" title="hnn_core.Network" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">net</span></a> <span class="o">=</span> <a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network" title="hnn_core.Network" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-class"><span class="n">Network</span></a><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Distal evoked drives share connection parameters</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_ampa_d</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L2_basket&#39;</span><span class="p">:</span> <span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;L2_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.0045</span><span class="p">,</span>
                  <span class="s1">&#39;L5_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_nmda_d</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L2_basket&#39;</span><span class="p">:</span> <span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;L2_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.0045</span><span class="p">,</span>
                  <span class="s1">&#39;L5_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">synaptic_delays_d</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L2_basket&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;L2_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                     <span class="s1">&#39;L5_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="c1"># early distal input</span>
<a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network.add_evoked_drive" title="hnn_core.Network.add_evoked_drive" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-method"><span class="n">net</span><span class="o">.</span><span class="n">add_evoked_drive</span></a><span class="p">(</span>
    <span class="s1">&#39;evdist1&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">32.</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">numspikes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights_ampa</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_ampa_d</span></a><span class="p">,</span>
    <span class="n">weights_nmda</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_nmda_d</span></a><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;distal&#39;</span><span class="p">,</span>
    <span class="n">synaptic_delays</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">synaptic_delays_d</span></a><span class="p">,</span> <span class="n">seedcore</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="c1"># late distal input</span>
<a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network.add_evoked_drive" title="hnn_core.Network.add_evoked_drive" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-method"><span class="n">net</span><span class="o">.</span><span class="n">add_evoked_drive</span></a><span class="p">(</span>
    <span class="s1">&#39;evdist2&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">82.</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">numspikes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights_ampa</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_ampa_d</span></a><span class="p">,</span>
    <span class="n">weights_nmda</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_nmda_d</span></a><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;distal&#39;</span><span class="p">,</span>
    <span class="n">synaptic_delays</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">synaptic_delays_d</span></a><span class="p">,</span> <span class="n">seedcore</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># proximal input occurs before distals</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_ampa_p</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L2_basket&#39;</span><span class="p">:</span> <span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;L2_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.0025</span><span class="p">,</span>
                  <span class="s1">&#39;L5_basket&#39;</span><span class="p">:</span> <span class="mf">0.004</span><span class="p">,</span> <span class="s1">&#39;L5_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_nmda_p</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L2_basket&#39;</span><span class="p">:</span> <span class="mf">0.003</span><span class="p">,</span> <span class="s1">&#39;L5_basket&#39;</span><span class="p">:</span> <span class="mf">0.004</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">synaptic_delays_p</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L2_basket&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;L2_pyramidal&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                     <span class="s1">&#39;L5_basket&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;L5_pyramidal&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network.add_evoked_drive" title="hnn_core.Network.add_evoked_drive" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-method"><span class="n">net</span><span class="o">.</span><span class="n">add_evoked_drive</span></a><span class="p">(</span>
    <span class="s1">&#39;evprox1&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">numspikes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights_ampa</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_ampa_p</span></a><span class="p">,</span>
    <span class="n">weights_nmda</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights_nmda_p</span></a><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;proximal&#39;</span><span class="p">,</span>
    <span class="n">synaptic_delays</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">synaptic_delays_p</span></a><span class="p">,</span> <span class="n">seedcore</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpl</span></a> <span class="o">=</span> <a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.simulate_dipole.html#hnn_core.simulate_dipole" title="hnn_core.simulate_dipole" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-function"><span class="n">simulate_dipole</span></a><span class="p">(</span><a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.Network.html#hnn_core.Network" title="hnn_core.Network" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">net</span></a><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_idx</span></a> <span class="o">=</span> <span class="mi">0</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpl</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trial_idx</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.CellResponse.html#hnn_core.CellResponse.plot_spikes_hist" title="hnn_core.CellResponse.plot_spikes_hist" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-method"><span class="n">net</span><span class="o">.</span><span class="n">cell_response</span><span class="o">.</span><span class="n">plot_spikes_hist</span></a><span class="p">(</span><span class="n">ax</span><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a href="https://jonescompneurolab.github.io/hnn-core/generated/hnn_core.CellResponse.html#hnn_core.CellResponse.plot_spikes_raster" title="hnn_core.CellResponse.plot_spikes_raster" class="sphx-glr-backref-module-hnn_core sphx-glr-backref-type-py-method"><span class="n">net</span><span class="o">.</span><span class="n">cell_response</span><span class="o">.</span><span class="n">plot_spikes_raster</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="Aggregate (L2 + L5)" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_simulate_somato_002.png" />
</li>
<li><img alt="plot simulate somato" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_simulate_somato_003.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>joblib will run over 1 jobs
Building the NEURON model
[Done]
running trial 1 on 1 cores
Simulation time: 0.03 ms...
Simulation time: 10.0 ms...
Simulation time: 20.0 ms...
Simulation time: 30.0 ms...
Simulation time: 40.0 ms...
Simulation time: 50.0 ms...
Simulation time: 60.0 ms...
Simulation time: 70.0 ms...
Simulation time: 80.0 ms...
Simulation time: 90.0 ms...
Simulation time: 100.0 ms...
Simulation time: 110.0 ms...

&lt;Figure size 640x480 with 1 Axes&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  5.202 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-simulate-somato-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/jonescompneurolab/hnn-core/gh-pages?filepath=stable/notebooks/auto_examples/plot_simulate_somato.ipynb"><img alt="Launch binder" src="../_images/binder_badge_logo.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ace698a06808c515febbbc2e1cdafd09/plot_simulate_somato.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_simulate_somato.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/dd6d9301e684dfd33feeb22df79d2ea2/plot_simulate_somato.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_simulate_somato.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Mainak Jas.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>